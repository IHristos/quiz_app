<!-- templates/results.html -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Your Quiz Results</title>
    <link rel="stylesheet" href="/static/style.css" />
  </head>
  <body>
    <button
      id="darkModeToggle"
      style="position: fixed; top: 20px; right: 20px; z-index: 1000"
    >
      üåô Dark Mode
    </button>
    <script>
      const toggleBtn = document.getElementById("darkModeToggle");
      const body = document.body;
      let dark = false;
      toggleBtn.onclick = function () {
        dark = !dark;
        if (dark) {
          body.classList.add("dark-mode");
          toggleBtn.textContent = "‚òÄÔ∏è Light Mode";
        } else {
          body.classList.remove("dark-mode");
          toggleBtn.textContent = "üåô Dark Mode";
        }
        localStorage.setItem("darkMode", dark ? "1" : "0");
      };
      // Persist mode
      if (localStorage.getItem("darkMode") === "1") {
        body.classList.add("dark-mode");
        toggleBtn.textContent = "‚òÄÔ∏è Light Mode";
        dark = true;
      }
    </script>
    <div class="container">
      <h1>Quiz Completed!</h1>
      <p>
        You got&nbsp;<strong>{{ score }}</strong>&nbsp;out of&nbsp;
        <strong>{{ results|length }}</strong>&nbsp;correct ‚Äî that's&nbsp;
        <strong>{{ percent }}%</strong>&nbsp;üéØ
      </p>

      {% for r in results %}
      <div class="result-block">
        <h3>
          Question {{ loop.index }} {% if r.multi %}<em
            >(choose multiple answers)</em
          >{% endif %}
        </h3>
        <p>{{ r.question }}</p>
        <ul>
          {% for a in r.answers %}
          <li>
            {% if a.is_selected and a.is_correct %}<span
              style="
                background-color: rgba(8, 255, 28, 0.155);
                border-radius: 10px;
              "
            >
              ‚úÖ <strong>{{ a.text }}</strong>
              <span style="color: green">(your answer)</span> </span
            >{% elif a.is_selected and not a.is_correct %}<span
              style="
                background-color: rgba(255, 8, 8, 0.155);
                border-radius: 10px;
              "
            >
              ‚ùå {{ a.text }}
              <span style="color: red">(your answer)</span></span
            >
            {% elif a.is_correct %}<span
              style="
                background-color: rgba(8, 255, 28, 0.155);
                border-radius: 10px;
              "
            >
              ‚¨ú <strong>{{ a.text }}</strong>
              <span style="color: rgb(0, 153, 255)"
                >(correct but not selected)</span
              ></span
            >
            {% else %} ‚¨ú {{ a.text }} {% endif %}
          </li>
          {% endfor %}
        </ul>
        <!-- <div style="font-size: 0.9em; color: #888; margin-bottom: 10px">
          <strong>Debug info:</strong><br />
          Selected (normalized): {{ r.selected|join(', ') }}<br />
          Correct (normalized): {{ r.correct|join(', ') }}
        </div> -->
        <p style="color: {{ 'green' if r.is_fully_correct else 'red' }};">
          {% if r.is_fully_correct %}‚úîÔ∏è Correct!{% else %}‚ùå Incorrect.{% endif
          %}
        </p>
        <hr />
      </div>
      {% endfor %}

      <a href="/retake">
        <button style="padding: 10px 20px; font-size: 1em">
          üîÅ Retake the Quiz
        </button>
      </a>
    </div>
  </body>
</html>
